<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Fruit Cut — Offline (with Eruda)</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container">
  <header class="header"><h1>🍉 Fruit Cut — Offline</h1></header>

  <div class="hud">
    <div class="stat">Score: <strong id="score">0</strong></div>
    <div class="stat">Lives: <strong id="lives">3</strong></div>
    <div class="stat">Coins: <strong id="coins">0</strong></div>
    <div class="stat">Level: <strong id="level">1</strong></div>
  </div>

  <div id="gameWrapper">
    <div id="gameArea" aria-label="Game area"></div>
    <div id="status"><span id="statusText">Running: NO</span></div>
    <div id="bigStart">START</div>
  </div>

  <div class="controls">
    <button id="startBtn" class="btn ghost">Start</button>
    <button id="pauseBtn" class="btn ghost">Pause</button>
    <button id="restartBtn" class="btn ghost">Restart</button>
    <button id="erudaToggle" class="btn ghost" title="Toggle eruda console">Console</button>
  </div>

  <p class="tip">Tip: Swipe fruits to slice. Avoid bombs 💣</p>
</div>

<!-- Eruda (mobile dev console) - loads from CDN -->
<script>
  // Load eruda only when user toggles or after small delay (so offline still works if CDN blocked)
  function loadEruda(callback){
    if(window.eruda) { if(callback) callback(); return; }
    var s = document.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/npm/eruda';
    s.onload = function(){ eruda.init(); console.log('Eruda loaded'); if(callback) callback(); };
    s.onerror = function(){ console.warn('Eruda failed to load from CDN'); };
    document.body.appendChild(s);
  }
  // Shortcut: load after 1.5s quietly (best-effort)
  setTimeout(()=> { try{ loadEruda(); } catch(e){ console.warn('Eruda load error', e); } }, 1500);
</script>

<script src="game.js"></script>
<script>
  // Toggle button for eruda in UI
  document.getElementById('erudaToggle').addEventListener('click', ()=>{
    if(window.eruda){
      <script>
  // ---- Replace previous Eruda loader + toggle code with this robust version ----

  // Track visibility ourselves
  let erudaVisible = false;

  function ensureEruda(cb){
    if(window.eruda){
      // already loaded
      return cb && cb();
    }
    const s = document.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/npm/eruda';
    s.async = true;
    s.onload = function(){
      try {
        // init and show UI
        eruda.init();
        erudaVisible = true;
        console.log('Eruda loaded & init done');
        if (typeof eruda.show === 'function') eruda.show();
      } catch(err){
        console.warn('Eruda init error', err);
      }
      if(cb) cb();
    };
    s.onerror = function(e){
      console.warn('Eruda failed to load from CDN', e);
      if(cb) cb(new Error('eruda-load-failed'));
    };
    document.head.appendChild(s);
  }

  // Toggle button behavior (safe)
  document.getElementById('erudaToggle').addEventListener('click', ()=>{
    // if eruda not loaded -> load and show
    if(!window.eruda){
      ensureEruda((err)=>{
        if(err){
          alert('Eruda load failed. Check network or use DevTools on desktop.');
          return;
        }
        // make sure visible flag is true if show available
        erudaVisible = !!(window.eruda && typeof window.eruda.show === 'function');
      });
      return;
    }

    // if loaded, toggle using show/hide if available
    try {
      if (erudaVisible) {
        if (typeof eruda.hide === 'function') {
          eruda.hide();
        } else {
          // fallback: try closing panels
          try { eruda.get && eruda.get('console') && eruda.get('console').hide && eruda.get('console').hide(); } catch(e){}
        }
        erudaVisible = false;
      } else {
        if (typeof eruda.show === 'function') {
          eruda.show();
        } else {
          try { eruda.get && eruda.get('console') && eruda.get('console').show && eruda.get('console').show(); } catch(e){}
        }
        erudaVisible = true;
      }
    } catch(ex){
      console.warn('eruda toggle safe-fallback error', ex);
    }
  });

  // Small best-effort auto-load (optional). If you don't want auto-load remove this.
  setTimeout(()=>{
    try {
      if (!window.eruda) ensureEruda();
    } catch(e) { console.warn('autoloader error', e); }
  }, 1500);

</script>
</body>
  </html>
