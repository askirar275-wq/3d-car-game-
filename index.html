<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>üçâ Fruit Cut ‚Äî Final Clean</title>
<style>
:root{--ui:#f4f7fb;--btn:#111}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;margin:0;background:var(--ui);font-family:Inter,system-ui,Roboto,Arial,sans-serif;color:#111}
.container{max-width:820px;margin:0 auto;padding:12px}
h1{text-align:center;margin:10px 0}
.hud{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-bottom:10px}
.stat{background:#fff;padding:8px 12px;border-radius:12px;box-shadow:0 8px 22px rgba(0,0,0,0.06);font-weight:700}
#gameWrapper{position:relative;border-radius:14px;overflow:hidden;background:linear-gradient(180deg,#bfe9ff,#f6f7fb);height:60vh;min-height:420px}
#gameArea{position:absolute;inset:0;z-index:2;touch-action:none}
canvas{position:absolute;inset:0;z-index:6;pointer-events:none}
.fruit,.half{position:absolute;transform:translate(-50%,-50%);user-select:none;pointer-events:none;z-index:5}
#bigStart{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:10;background:var(--btn);color:#fff;padding:14px 18px;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 12px 34px rgba(0,0,0,0.25)}
.controls{display:flex;gap:12px;justify-content:center;padding:16px;margin-top:8px}
.btn{background:#fff;border:0;padding:10px 18px;border-radius:12px;cursor:pointer;box-shadow:0 10px 26px rgba(2,6,23,0.06);font-weight:700}
#gameOver{position:absolute;inset:0;z-index:20;display:none;align-items:center;justify-content:center}
.card{background:#fff;padding:16px;border-radius:12px;box-shadow:0 8px 26px rgba(0,0,0,0.1)}
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:rgba(0,0,0,0.8);color:#fff;padding:8px 14px;border-radius:999px;z-index:999;display:none}
</style>
</head>
<body>
<div class="container">
  <h1>üçâ Fruit Cut ‚Äî Final</h1>
  <div class="hud">
    <div class="stat">Score: <span id="score">0</span></div>
    <div class="stat">Lives: <span id="lives">3</span></div>
    <div class="stat">Coins: <span id="coins">0</span></div>
    <div class="stat">Level: <span id="level">1</span></div>
  </div>

  <div id="gameWrapper">
    <div id="gameArea"></div>
    <canvas id="bladeCanvas"></canvas>
    <canvas id="particles"></canvas>
    <div id="bigStart">START</div>

    <div id="gameOver">
      <div class="card" style="text-align:center">
        <h2>Game Over</h2>
        <p>Score: <span id="goScore">0</span></p>
        <p>Best: <span id="goBest">0</span></p>
        <button id="goRestart" class="btn">Play Again</button>
      </div>
    </div>
  </div>

  <div class="controls">
    <button id="startBtn" class="btn">Start</button>
    <button id="pauseBtn" class="btn">Pause</button>
    <button id="restartBtn" class="btn">Restart</button>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
(() => {
  const IMG_PATH = 'images/';
  const FRUITS = ['apple.png','banana.png','orange.png','mango.png','pear.png','plum.png','watermelon.png','pomegranate.png'];
  const BOMB = 'bomb.png';
  const ALL = FRUITS.concat([BOMB]);
  const area = document.getElementById('gameArea');
  const bladeCanvas = document.getElementById('bladeCanvas');
  const particlesCanvas = document.getElementById('particles');
  const bigStart = document.getElementById('bigStart');
  const startBtn = document.getElementById('startBtn');
  const pauseBtn = document.getElementById('pauseBtn');
  const restartBtn = document.getElementById('restartBtn');
  const gameOver = document.getElementById('gameOver');
  const goRestart = document.getElementById('goRestart');
  const goScore = document.getElementById('goScore');
  const goBest = document.getElementById('goBest');
  const toast = document.getElementById('toast');
  const scoreEl = document.getElementById('score');
  const livesEl = document.getElementById('lives');
  const coinsEl = document.getElementById('coins');
  const levelEl = document.getElementById('level');
  const bctx = bladeCanvas.getContext('2d');
  const pctx = particlesCanvas.getContext('2d');

  let running=false,paused=false;
  let score=0,lives=3,coins=0,level=1;
  let fruits=[],particles=[],bladePoints=[];
  let spawnTimer=null,imageCache={};

  const rand=(a,b)=>Math.random()*(b-a)+a;
  function showToast(msg){toast.textContent=msg;toast.style.display='block';setTimeout(()=>toast.style.display='none',1000);}
  function resize(){const r=area.getBoundingClientRect();bladeCanvas.width=r.width;bladeCanvas.height=r.height;particlesCanvas.width=r.width;particlesCanvas.height=r.height;}
  window.addEventListener('resize',resize);

  function preloadAll(){return Promise.all(ALL.map(n=>new Promise(res=>{const i=new Image();i.onload=()=>{imageCache[n]=i;res();};i.onerror=()=>res();i.src=IMG_PATH+n;})))}

  function spawn(){
    if(!running||paused)return;
    const isBomb=Math.random()<0.08;
    const name=isBomb?BOMB:FRUITS[Math.floor(Math.random()*FRUITS.length)];
    const el=document.createElement('img');
    el.src=imageCache[name]?imageCache[name].src:IMG_PATH+name;
    el.className='fruit';
    el.style.width='70px';
    el.style.left=rand(60,area.clientWidth-60)+'px';
    el.style.top=area.clientHeight+40+'px';
    area.appendChild(el);
    fruits.push({name,isBomb,el,x:parseFloat(el.style.left),y:parseFloat(el.style.top),vx:rand(-2,2),vy:-rand(10,14),rot:0,sliced:false});
  }

  function update(){
    for(let i=fruits.length-1;i>=0;i--){
      const f=fruits[i];
      f.vy+=0.36;f.x+=f.vx;f.y+=f.vy;f.rot+=2;
      f.el.style.left=f.x+'px';f.el.style.top=f.y+'px';f.el.style.transform=`translate(-50%,-50%) rotate(${f.rot}deg)`;
      if(f.y>area.clientHeight+100){f.el.remove();fruits.splice(i,1);}
    }
  }

  function draw(){
    bctx.clearRect(0,0,bladeCanvas.width,bladeCanvas.height);
    if(bladePoints.length>1){
      bctx.strokeStyle='#22c55e';bctx.lineJoin='round';bctx.lineCap='round';
      for(let i=0;i<bladePoints.length-1;i++){
        const a=bladePoints[i],b=bladePoints[i+1];
        const alpha=Math.max(0,1-(Date.now()-a.t)/350);
        bctx.globalAlpha=alpha;bctx.lineWidth=14*alpha;
        bctx.beginPath();bctx.moveTo(a.x,a.y);bctx.lineTo(b.x,b.y);bctx.stroke();
      }bctx.globalAlpha=1;
    }
  }

  function onPointerMove(e){
    if(!running||paused)return;
    const r=area.getBoundingClientRect();
    const x=e.clientX-r.left,y=e.clientY-r.top;
    bladePoints.push({x,y,t:Date.now()});if(bladePoints.length>26)bladePoints.shift();
    for(let i=fruits.length-1;i>=0;i--){
      const f=fruits[i];
      if(f.sliced)continue;
      const rect=f.el.getBoundingClientRect();
      if(x+ r.left>=rect.left && x+r.left<=rect.right && y+r.top>=rect.top && y+r.top<=rect.bottom){
        f.sliced=true;
        if(f.isBomb){
          lives--;showToast('üí£ Oops!');
          if(lives<=0)return endGame();
        }else{
          score+=10;coins++;
        }
        updateHUD();f.el.remove();fruits.splice(i,1);
      }
    }
  }

  function physicsTick(){if(running&&!paused){update();draw();}requestAnimationFrame(physicsTick);}
  function startSpawning(){clearInterval(spawnTimer);spawnTimer=setInterval(spawn,900);}
  function stopSpawning(){clearInterval(spawnTimer);spawnTimer=null;}
  function startGame(){gameOver.style.display='none';if(running)return;running=true;paused=false;score=0;lives=3;coins=0;updateHUD();bigStart.style.display='none';startSpawning();}
  function pauseGame(){paused=!paused;pauseBtn.textContent=paused?'Resume':'Pause';}
  function restartGame(){stopSpawning();fruits.forEach(f=>f.el.remove());fruits=[];running=false;paused=false;startGame();}
  function endGame(){running=false;stopSpawning();goScore.textContent=score;const best=Math.max(localStorage.getItem('best')||0,score);localStorage.setItem('best',best);goBest.textContent=best;gameOver.style.display='flex';}
  function updateHUD(){scoreEl.textContent=score;livesEl.textContent=lives;coinsEl.textContent=coins;levelEl.textContent=level;}

  startBtn.onclick=startGame;
  pauseBtn.onclick=pauseGame;
  restartBtn.onclick=restartGame;
  goRestart.onclick=restartGame;
  bigStart.onclick=startGame;
  window.addEventListener('pointermove',onPointerMove);
  window.addEventListener('pointerdown',onPointerMove);
  window.addEventListener('pointerup',()=>bladePoints=[]);

  function init(){resize();physicsTick();preloadAll().then(()=>setTimeout(()=>{if(!running)startGame(true);},300));}
  window.addEventListener('load',init);
})();
</script>
</body>
</html>
